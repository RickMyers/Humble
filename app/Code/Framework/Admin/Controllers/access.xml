<?xml version="1.0"?>
<!--

Access log actions

For Controller reference, please see "Anatomy of a Controller" at https://www.humbleprogramming.com/pages/Controllers.htmls
-->
<controller name="access" use="Twig" author="Myers Rick" email="rick@humbleprogramming.com">
    <actions blocking="off" response="false">
        
        <action name="home" passalong="window_id">
            <description>The main page</description>
        </action>

        <!-- ############################################################### -->

        <action name="list" passalong="window_id">
            <description>Lists the log files in a directory</description>
            <helper namespace="admin" class="log" id="directory">
                <parameter name="directory" source="request" required="true" />
            </helper>
        </action>

        <!-- ############################################################### -->
        
        <action name="summarize" passalong="window_id">
            <description>Summarizes an access log and presents the details</description>
            <helper namespace="admin" class="log" id="log">
                <parameter name="directory" source="request" required="true" />
                <parameter name="log" source="request" required="true" />
            </helper>            
        </action>
        
        <!-- ############################################################### -->
        
        <action name="whois" passalong="window_id">
            <description>Runs a "whois" on an IP address and presents the results</description>
            <helper namespace="admin" class="log" id="log">
                <parameter name="host" source="request" required="true" />
            </helper>
        </action>
        
        <!-- ############################################################### -->
        
        <action name="whoishost" passalong="window_id">
            <description>Runs a "whois" on an IP address and presents the results</description>
            <helper namespace="admin" class="log" id="log">
                <parameter name="host" source="request" required="true" />
            </helper>
        </action>        
        
        <!-- ############################################################### -->
        
        <action name="permaban" response="true">
            <description>Will permanently ban a host IP</description>
            <helper namespace="admin" class="log" method="permaban">
                <parameter name="host" source="post" required="true" />
            </helper>
        </action>
        
        <!-- ############################################################### -->
        
        <action name="7dayban" response="true">
            <description>Will permanently ban a host IP</description>
            <helper namespace="admin" class="log" method="sevendayban">
                <parameter name="host" source="post" required="true" />
            </helper>
        </action>
                
    </actions>
</controller>